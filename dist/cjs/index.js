"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function r(e){return parseInt(String(e).trim(),10)}function n(e){return null==e}function t(e){return"object"==typeof e&&null!==e&&0===Object.keys(e).length||(!(!Array.isArray(e)||e.length)||""===String(e).trim())}var u=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;function i(e){return void 0===e&&(e="Value must be numeric"),function(r){return n(r)||t(r)||String(r).match(/^\-{0,1}[0-9]+$/)?null:e}}var c=function(){return c=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var u in r=arguments[n])Object.prototype.hasOwnProperty.call(r,u)&&(e[u]=r[u]);return e},c.apply(this,arguments)};function o(e){return e?Array.from(e.querySelectorAll("input, select, textarea")||[]):[]}function a(e,r){if(!e)return{};var n={};return Object.keys(r).forEach((function(t){var u=function(e,r){if(!e)return null;var n=Array.from(e.querySelectorAll('[name="'.concat(r,'"]')));return n.length?n:null}(e,t);if(u)switch(n[t]=u,u[0].type){case"checkbox":u[0].checked=Boolean(r[t]);break;case"radio":u.forEach((function(e){return e.checked=e.value===r[t]}));break;case"file":u[0].value="";break;case"submit":case"reset":case"image":break;default:u[0].value=String(r[t])}})),n}exports.decimal=function(e){return void 0===e&&(e="Value must be decimal"),function(r){return n(r)||t(r)||String(r).match(/^\d*\.?\d*$/)?null:e}},exports.email=function(e){return void 0===e&&(e="Invalid email"),function(r){return n(r)||t(r)||u.test(String(r).toLowerCase())?null:e}},exports.equal=function(e,r){return void 0===r&&(r="Values must be equal"),function(u,i){var c=n(u)||t(u),o=!i||n(i[e])||t(i[e]);return!i||u===i[e]||c||o?null:r}},exports.isEmpty=t,exports.isUndefinedOrNull=n,exports.max=function(e,u){return void 0===u&&(u="Max ".concat(e)),function(c){if(n(c)||t(c))return null;var o=i()(c);return o||(r(c)>e?u:null)}},exports.maxLength=function(e,r){return void 0===r&&(r="Max length ".concat(e)),function(u){return n(u)||t(u)?null:String(u).trim().length>e?r:null}},exports.min=function(e,u){return void 0===u&&(u="Min ".concat(e)),function(c){if(n(c)||t(c))return null;var o=i()(c);return o||(r(c)<e?u:null)}},exports.minLength=function(e,r){return void 0===r&&(r="Min length ".concat(e)),function(u){return n(u)||t(u)?null:String(u).trim().length<e?r:null}},exports.numeric=i,exports.pattern=function(e,r){return void 0===r&&(r="Invalid pattern"),function(u){return n(u)||t(u)||!e||("string"==typeof e?new RegExp(e):e).test(String(u))?null:r}},exports.required=function(e){return void 0===e&&(e="Value is required"),function(r){return n(r)||""===r||t(r)?e:null}},exports.requiredTrue=function(e){return void 0===e&&(e="Value must be true"),function(r){return"true"!==String(r)?e:null}},exports.useForm=function(r,n){var t=e.useRef(null),u=e.useRef({}),i=e.useState(!1),l=i[0],s=i[1],f=e.useState({}),v=f[0],d=f[1],m=e.useState({}),h=m[0],g=m[1],p=e.useCallback((function(e){var n,i=function(e,r){var n={};return Object.keys(e).forEach((function(t){var u=e[t][1],i=!0;(u||[]).forEach((function(e){if("function"==typeof e){var u=e.call(null,r[t],r);i&&u&&(i=!1,n[t]=u)}}))})),{valid:0===Object.keys(n).length,errors:n}}(r,e||v||{}),c=i.valid,o=i.errors;return g(o),null===(n=t.current)||void 0===n||n.classList[c?"remove":"add"]("uf-invalid"),Object.entries(u.current).forEach((function(e){var r=e[0];e[1].forEach((function(e){e.classList[o[r]?"add":"remove"]("uf-invalid")}))})),{valid:c,errors:o}}),[r,v]),b=e.useCallback((function(e){var r,u=e.target,i=u.type,o=u.checked,a=u.value,l=u.name,s=u.classList,f="checkbox"===i?!!o:a;if(!l)throw Error("Name is required for a Form Element");var v,m="submit"!==(null==n?void 0:n.validateOn);s.contains("uf-touched")||s.add("uf-touched"),m&&(s.add("uf-changed"),null===(r=t.current)||void 0===r||r.classList.add("uf-changed")),d((function(e){var r;if(v=c(c({},e||{}),((r={})[l]=f,r)),m){var n=p(v).errors;s[n[l]?"add":"remove"]("uf-invalid")}return v}))}),[d,p]),E=e.useCallback((function(){return s(!0),p()}),[p,s]),L=JSON.stringify(function(e){return Object.keys(e).reduce((function(r,n,t){return r[n]=e[n][0],r}),{})}(r));return e.useEffect((function(){var e=JSON.parse(L)||{};function r(r){var n,i,c,o;r.preventDefault(),null===(n=t.current)||void 0===n||n.classList.remove("uf-submitted"),null===(i=t.current)||void 0===i||i.classList.remove("uf-invalid"),null===(c=t.current)||void 0===c||c.classList.remove("uf-touched"),null===(o=t.current)||void 0===o||o.classList.remove("uf-changed"),s(!1),d(e),g({}),u.current=a(t.current,e),Object.values(u.current).forEach((function(e){e.forEach((function(e){e.classList.remove("uf-invalid"),e.classList.remove("uf-touched"),e.classList.remove("uf-changed")}))}))}d(e),u.current=a(t.current,e);var n=t.current;return n&&n.addEventListener("reset",r),function(){n&&n.removeEventListener("reset",r)}}),[L,d,g,s]),e.useEffect((function(){if(t.current){var e="change"===(null==n?void 0:n.validateOn)?"input":"change",r=t.current;return o(r).forEach((function(r){return r.addEventListener(e,b)})),function(){r&&o(r).forEach((function(r){return r.removeEventListener(e,b)}))}}}),[n,b]),e.useEffect((function(){var e=t.current;function r(e){var r;null===(r=t.current)||void 0===r||r.classList.add("uf-touched"),(null==e?void 0:e.target).classList.add("uf-touched")}return o(e).forEach((function(e){return e.addEventListener("focus",r)})),function(){e&&o(e).forEach((function(e){return e.removeEventListener("focus",r)}))}})),e.useEffect((function(){function e(){var e;null===(e=t.current)||void 0===e||e.classList.add("uf-submitted"),E()}var r=t.current;return r&&r.addEventListener("submit",e),function(){r&&r.removeEventListener("submit",e)}}),[E]),{ref:t,submitted:l,valid:!Object.keys(h).length,data:v,errors:h,change:b,set:function(e,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1),s(n),g({});var i=c(r?{}:c({},v||{}),e);d(i),u.current=a(t.current,i)},validate:p,submit:E}};
//# sourceMappingURL=index.js.map
